## 1. Что было сделано

### 1.1. Анализ и подготовка данных
- **Загрузка данных**: Реализована загрузка демо-данных с GitHub или пользовательских CSV файлов
- **Анализ качества**: Проведен анализ пропущенных значений, дубликатов и типов данных
- **Предобработка**: Реализованы функции для очистки и преобразования признаков:
  - Обработка текстовых полей (`mileage`, `engine`, `max_power`, `torque`)
  - Извлечение бренда из названия автомобиля
  - Заполнение пропусков медианными значениями
  - Преобразование типов данных

### 1.2. Разведочный анализ данных (EDA)
- **Визуализация распределений**: Построены графики распределения цен и других признаков
- **Корреляционный анализ**: Создана тепловая карта корреляций между признаками
- **Анализ зависимостей**: Исследована зависимость цены от различных факторов
- **Категориальный анализ**: Визуализировано распределение по категориальным признакам

### 1.3. Построение моделей машинного обучения
- **Подготовка признаков**: Стандартизация числовых признаков с помощью `StandardScaler`
- **Обучение моделей**: Реализованы 4 типа регрессионных моделей:
  - Линейная регрессия (базовая модель)
  - Lasso регрессия (L1-регуляризация)
  - Ridge регрессия (L2-регуляризация)
  - ElasticNet регрессия (комбинированная регуляризация)
- **Настройка гиперпараметров**: Добавлены слайдеры для ручной настройки параметров моделей

### 1.4. Создание Streamlit-приложения
- **Навигационная структура**: Разработано 7 разделов с четкой логикой работы
- **Визуализация результатов**: Графики сравнения моделей, анализа остатков и важности признаков
- **Интерактивность**: Реализованы возможности:
  - Ручной ввод параметров автомобиля
  - Сохранение и загрузка обученных моделей
- **Pipeline архитектура**: Реализовано сохранение полного pipeline (scaler + model) в pickle файлы

# Отчет по проекту: Аналитическая система прогнозирования цен на автомобили

## 2. Какие результаты были получены (метрики + интерпретация)

### 2.1. Метрики качества моделей
На тестовой выборке были получены следующие результаты:

| Модель | R² (обучение) | R² (тест) | RMSE (тест) | MAE (тест) |
|--------|---------------|-----------|-------------|------------|
| **Линейная регрессия** | 0.6407 | 0.6523 | 447,086 | 273,626 |
| **Lasso (α=1.0)** | 0.6407 | 0.6523 | 447,085 | 273,626 |
| **Ridge (α=1.0)** | 0.6407 | 0.6523 | 447,080 | 273,601 |
| **ElasticNet (α=0.1, l1=0.5)** | 0.6385 | **0.6529** | **446,698** | **266,412** |

### 2.2. Интерпретация результатов
- **ElasticNet показал лучшие результаты**: Коэффициент детерминации R² = 0.6529 означает, что модель объясняет **65.29% дисперсии цен** на автомобили. Это умеренный показатель качества для задачи регрессии.

- **Сходство метрик между моделями**: 
  - Линейная регрессия, Lasso и Ridge показали практически идентичные результаты (R² = 0.6523)
  - Это указывает на то, что в данных нет сильной мультиколлинеарности, и регуляризация не дает значимого преимущества при стандартных параметрах

- **Преимущество ElasticNet**:
  - Небольшое улучшение R² 
  - Модель ElasticNet объединяет преимущества L1 и L2 регуляризации, что позволило немного улучшить качество

- **Анализ переобучения**:
  - Разница между R² на обучении и тесте минимальна (0.6407-0.6529)
  - Это указывает на отсутствие сильного переобучения
  - Модели хорошо обобщают данные

- **Качество модели в контексте задачи**:
  - R² = 0.65 - это умеренный результат
  - Вероятные причины ограниченного качества:
    - Линейные модели не могут уловить сложные нелинейные зависимости
    - В данных могут отсутствовать важные признаки
    - Возможны выбросы, влияющие на качество прогноза
    - Может требоваться более сложная предобработка категориальных признаков

### 2.3. Сравнительный анализ моделей
1. **Линейная регрессия** - базовая модель, показывает удовлетворительные результаты
2. **Lasso и Ridge** - практически не отличаются от линейной регрессии при выбранных параметрах
3. **ElasticNet** - показал небольшое, но стабильное улучшение по всем метрикам

### 2.4. Рекомендации по улучшению
1. **Тюнинг гиперпараметров**: Более тонкая настройка alpha и l1_ratio для ElasticNet
2. **Нелинейные преобразования**: Добавление полиномиальных признаков или логарифмирование целевой переменной
3. **Улучшение признакового пространства**:
   - Более глубокая обработка категориальных признаков
   - Создание новых признаков на основе существующих
   - Удаление или преобразование выбросов

## 3. Что дало наибольший прирост качества

### 3.1. Анализ результатов
Из представленных результатов видно, что:

1. **ElasticNet дал небольшой прирост качества**:
   - Улучшение R² на 0.0006 по сравнению с другими моделями
   - Снижение RMSE на ~400 единиц
   - Значительное снижение MAE на ~7,000 единиц

2. **Регуляризация не показала значительного преимущества**:
   - Lasso и Ridge с параметром α=1.0 дали практически те же результаты, что и обычная линейная регрессия
   - Это может указывать на:
     - Неоптимальные значения гиперпараметров
     - Отсутствие сильной мультиколлинеарности в данных
     - Необходимость других значений регуляризации

3. **Комбинированная регуляризация (ElasticNet) оказалась эффективнее**:
   - Сочетание L1 и L2 регуляризации позволило лучше справиться с особенностями данных
   - Model смогла выбрать оптимальный баланс между отбором признаков (L1) и уменьшением весов (L2)

### 3.2. Причины ограниченного прироста качества
1. **Ограниченность линейных моделей**: Данные могут содержать сложные нелинейные зависимости
2. **Проблемы с признаками**: 
   - Возможна неполная предобработка категориальных признаков
   - Отсутствие важных для прогнозирования признаков
3. **Выбросы**: Необработанные выбросы могут влиять на качество линейных моделей

## 4. Что сделать не удалось и почему

### 4.1. Улучшение качества моделей выше R²=0.77
- **Ограничение линейными моделями**: Использовались только линейные методы, которые не могут уловить сложные нелинейные зависимости

### 4.2. Обработка выбросов
- **Не реализована автоматическая обработка**: Выбросы могли негативно влиять на качество моделей
- **Причина**: Решение оставить выбросы для сохранения реального распределения данных

## 5. Оценка разработанного сервиса

### 5.1. Удобство использования
- **Плюсы**:
  - Интуитивная навигация по разделам
  - Пошаговый процесс от загрузки данных до прогнозирования
  - Возможность как ручного ввода, так и загрузки файлов
  - Наглядные графики и визуализации

- **Минусы**:
  - При первом использовании может быть неочевиден порядок действий
  - Нет возможности возврата на предыдущий шаг без потери данных
  - Отсутствие подсказок при вводе данных

### 5.2. Качество визуализаций
- **Что получилось хорошо**:
  - Графики распределения цен и признаков (четкие, информативные)
  - Корреляционная матрица (наглядное представление зависимостей)
  - Графики фактических vs прогнозных значений (легкая интерпретация ошибок)

- **Что можно улучшить**:
  - Интерактивность графиков (возможность увеличения, сохранения)
  - Цветовые схемы некоторых графиков (лучшая различимость)

### 5.3. Замеченные ограничения и проблемы
1. **Производительность**:
   - При больших объемах данных (~10,000+ строк) загрузка и обработка могут занимать время
   - Нет индикатора прогресса для длительных операций

2. **Стабильность**:
   - При загрузке некорректных CSV файлов могут возникать ошибки без понятных сообщений
   - Session State может сбрасываться при некоторых действиях

3. **Функциональность**:
   - Нет возможности сравнения нескольких моделей на одном графике
   - Отсутствует автоматическое логирование экспериментов
   - Нет экспорта отчетов в PDF или других форматах

4. **Данные**:
   - Жесткая привязка к структуре данных автомобилей
   - Сложность адаптации для других типов данных без изменения кода


## Заключение

Разработанное Streamlit-приложение представляет собой полнофункциональную систему для анализа данных и построения моделей машинного обучения. Приложение успешно решает поставленную задачу прогнозирования цен на автомобили, предоставляя пользователям интуитивно понятный интерфейс для всех этапов работы с данными.

**Ключевые достижения**:
1. Реализация полного цикла ML проекта в одном приложении
2. Качественная визуализация данных и результатов
3. Гибкая система сохранения и загрузки моделей
4. Поддержка различных сценариев использования

**Рекомендации для использования**:
- Для задач регрессии с табличными данными
- В образовательных целях для изучения основ ML
- Для быстрого прототипирования моделей
- В качестве основы для более сложных аналитических систем

Приложение готово к использованию и может служить хорошей основой для дальнейшего развития в полноценную аналитическую платформу.
